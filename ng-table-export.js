/*! ngTableExport v0.1.0 by Vitalii Savchuk(esvit666@gmail.com) - https://github.com/esvit/ng-table-export - New BSD License */

angular.module("ngTableExport",[]).config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|data):/)}]).directive("exportCsv",["$parse","$timeout","ngTableEventsChannel",function(a,b,c){var d=",",e="data:text/csv;charset=UTF-8,";return{restrict:"A",scope:!1,link:function(f,g,h){function i(a){return h.noQuotation?a.replace(/^\s\s*/,"").replace(/\s*\s$/,""):'"'+a.replace(/^\s\s*/,"").replace(/\s*\s$/,"").replace(/"/g,'""')+'"'}function j(){m="";var a=g.find("tr");angular.forEach(a,function(a,b){var c=angular.element(a),e=c.find("th"),f="";c.hasClass("ng-table-filters")||(0===e.length&&(e=c.find("td")),1!==b&&(angular.forEach(e,function(a){f+=i(angular.element(a).text())+Array.apply(null,Array(a.colSpan)).map(function(){return d}).join("")}),f=f.slice(0,f.length-1)),m+=f+"\n")}),m="sep="+d+"\n"+m}function k(a,c,d){var e=document.createElement("a");e.style.display="none",e.href=a,e.download=c,e.target="_blank",b(function(){try{document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(a){throw d.logError&&d.logError("NG Table Export Error saving file on client."),a}},0,!1)}function l(a,c,d){if(window.navigator.msSaveOrOpenBlob)b(function(){try{window.navigator.msSaveBlob(a,c)}catch(b){throw d.logError&&d.logError("NG Table Export Error saving file on client (MS)."),b}},0,!1);else{var e=window.document.createElement("a");e.style.display="none",e.href=window.URL.createObjectURL(a),e.download=c,e.target="_blank",b(function(){try{document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(a){throw d.logError&&d.logError("NG Table Export Error saving file on client."),a}},0,!1)}}var m="";h.delimiter&&(d=h.delimiter,"TAB"===d&&(d="	"));var n={generate:function(a,d,g){var i=h.ngTable,g=g||f.$parent.tableParams,n=g?g.settings():{},o=g?g.count():{},p=g?n.total:{};if(i&&p>o){var q=c.onAfterReloadData(function(){q(),b(function(){j(),g.count(o),g.reload();var a=new Blob([m],{type:"text/csv"});l(a,d,f)},1e3,!1)});g.count(1/0),g.reload()}else j(),k(e+encodeURIComponent(m),d)}};a(h.exportCsv).assign(f.$parent,n)}}}]);
//# sourceMappingURL=ng-table-export.js.map